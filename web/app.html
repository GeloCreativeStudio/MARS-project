<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="MARS is a Multifunctional AI-Responsive System.">
    <meta name="keywords" content="MARS, AI, Artificial Intelligence, Responsive System">
    <meta name="author" content="Angelo Manalo">

    <!-- Preload critical assets -->
    <link rel="preload" href="/assets/css/styles.min.css" as="style">
    <link rel="preload" href="/assets/js/main.min.js" as="script">
    <link rel="preload" href="/assets/js/script.min.js" as="script">

    <!-- FAVICON -->
    <link rel="shortcut icon" href="assets/img/favicon/favicon.ico" type="image/x-icon">

    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/swiper-bundle.min.css">
    <link rel="stylesheet" href="/assets/css/styles.min.css">

    <!-- Defer non-critical scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/addons/p5.sound.min.js" defer></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" defer></script>
    <script src="https://unpkg.com/typeit@8.7.1/dist/index.umd.js" defer></script>

    <!-- Remix Icons -->
    <link href="https://cdn.jsdelivr.net/npm/remixicon@4.1.0/fonts/remixicon.css" rel="stylesheet">
</head>

<body>
    <!-- Header -->
    <header class="header" id="header">
        <nav class="nav container">
            <a href="#" class="nav__logo">
                <i class="ri-circle-fill"></i> MARS
            </a>
        </nav>
    </header>

    <!-- Main Content -->
    <main class="main">
        <!-- Home Section -->
        <section class="home section" id="home">
            <div class="shape shape__big"></div>
            <div class="shape shape__small"></div>
            <div class="home__container container grid">
                <div class="home__data">
                    <h2 class="home__subtitle">Multifunctional AI-Responsive System</h2>
                    <h3 class="home__mars">
                        <i class="ri-circle-line"></i>The future is here
                    </h3>
                </div>

                <h1 class="img-fluid" id="head"></h1>

                <div class="message__container">
                    <textarea id="transcription-box" class="" placeholder="Your query goes here..." disabled></textarea>
                    <p class="message-description">
                        <i class="ri-mic-line"></i> to start talking, <i class="ri-mic-off-line"></i> to send your query.
                    </p>
                </div>

                <a type="button" class="home__button" id="record-button">
                    <i class="ri-mic-line"></i>
                </a>

                <button type="button" style="display: none;" id="ask-button"></button>

                <p class="home__button-description">TALK TO MARS</p>

                <!-- Audio Player -->
                <div class="audio-player">
                    <audio id="audio-element"></audio>
                </div>
            </div>
        </section>

        <!-- Response Section -->
        <section class="section" id="response">
            <div class="response">
                <div class="about__data">
                    <h2 class="section__title response__title">
                        <i class="ri-message-3-line"></i> MARS Response:
                    </h2>
                    <p class="response__description">
                        Sometimes MARS might mishear you, so please double-check his responses.
                    </p>
                    <p class="response__main" id="response-text"></p>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="footer section">
            <div class="shape shape__big"></div>
            <div class="shape shape__small"></div>

            <div class="footer__container container grid">
                <div class="footer__content">
                    <a href="#" class="footer__logo">
                        <i class="ri-circle-fill"></i> MARS
                    </a>
                    <p class="footer__description">
                        MARS is currently in its initial version. Expect more exciting features coming soon.
                    </p>
                    <a href="https://grvu4q3ipr8.typeform.com/to/Fwi5eCUT" class="feedback__description">
                        <i class="ri-feedback-line"></i> Give us feedback
                    </a>
                </div>

                <div class="footer__content">
                    <h3 class="footer__title">Research & Development</h3>
                    <ul class="footer__links">
                        <li><a href="https://www.facebook.com/janine.lozano.35" class="footer__link">Alysa Janine Linga</a></li>
                        <li><a href="https://www.facebook.com/althea.baliwas" class="footer__link">Althea Baliwas</a></li>
                        <li><a href="https://www.facebook.com/mejico.aram" class="footer__link">Aram Neftali Mejico</a></li>
                        <li><a href="https://www.facebook.com/alm1017" class="footer__link">Angelo Manalo</a></li>
                        <li><a href="https://www.facebook.com/profile.php?id=100093702846439" class="footer__link">Billy Yndrew Justiniano</a></li>
                        <li><a href="https://www.facebook.com/kathrynleigh.guavesii" class="footer__link">Kathryn Leigh Guaves</a></li>
                    </ul>
                </div>

                <div class="footer__content">
                    <h3 class="footer__title">BSCS Instructors</h3>
                    <ul class="footer__links">
                        <li><a href="https://www.facebook.com/hartzell.majaba.5" class="footer__link">Hartzell Majaba</a></li>
                        <li><a href="https://www.facebook.com/jnpdrck" class="footer__link">John Pedrick Hilot</a></li>
                        <li><a href="https://www.facebook.com/johnmark.galang.7" class="footer__link">Mark Galang</a></li>
                    </ul>
                </div>
            </div>
            <span class="footer__copy">&copy; 2024 MARS. All rights reserved.</span>
        </footer>

        <!-- Scroll Up -->
        <a href="#" class="scrollup" id="scroll-up">
            <i class="ri-arrow-up-s-line scrollup__icon"></i>
        </a>

        <!-- Load p5.js sketch dynamically -->
        <canvas id="audio-visualizer" width="800" height="200"></canvas>

        <!-- Scripts -->
        <script src="/assets/js/scrollreveal.min.js" defer></script>
        <script src="/assets/js/swiper-bundle.min.js" defer></script>
        <script src="/assets/js/mixitup.min.js" defer></script>
        <script src="/assets/js/main.min.js" defer></script>
        <script src="/assets/js/script.min.js" defer></script>
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const analyser = audioContext.createAnalyser();
                const canvas = document.getElementById('audio-visualizer');
                const ctx = canvas.getContext('2d');
                
                analyser.fftSize = 256;
                const bufferLength = analyser.frequencyBinCount;
                const dataArray = new Uint8Array(bufferLength);

                function drawVisualizer() {
                    requestAnimationFrame(drawVisualizer);

                    analyser.getByteFrequencyData(dataArray);

                    ctx.fillStyle = 'rgb(0, 0, 0)';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);

                    const barWidth = (canvas.width / bufferLength) * 2.5;
                    let x = 0;

                    for (let i = 0; i < bufferLength; i++) {
                        const barHeight = dataArray[i] / 2;

                        ctx.fillStyle = `rgb(${barHeight + 100}, 50, 50)`;
                        ctx.fillRect(x, canvas.height - barHeight, barWidth, barHeight);

                        x += barWidth + 1;
                    }
                }

                // Connect the audio element to the analyser
                const audioElement = document.getElementById('audio-element');
                const source = audioContext.createMediaElementSource(audioElement);
                source.connect(analyser);
                analyser.connect(audioContext.destination);

                drawVisualizer();
            });
        </script>
    </main>
</body>

</html>
